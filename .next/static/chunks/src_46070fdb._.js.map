{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Dell/Desktop/digitomreact-10/digitom-nextjs/src/lib/auth.ts"],"sourcesContent":["import bcrypt from 'bcryptjs'\r\nimport jwt from 'jsonwebtoken'\r\n\r\n// Admin credentials (in production, store these in environment variables)\r\nconst ADMIN_CREDENTIALS = {\r\n  email: 'admin@digitom.com',\r\n  password: 'admin123', // In production, use a strong password\r\n  role: 'super_admin'\r\n}\r\n\r\nconst JWT_SECRET = process.env.JWT_SECRET || 'your-secret-key-change-in-production'\r\n\r\nexport interface AdminUser {\r\n  id: string\r\n  email: string\r\n  role: string\r\n}\r\n\r\nexport interface LoginCredentials {\r\n  email: string\r\n  password: string\r\n}\r\n\r\n// Hash password (for initial setup)\r\nexport function hashPassword(password: string): string {\r\n  return bcrypt.hashSync(password, 10)\r\n}\r\n\r\n// Verify password\r\nexport function verifyPassword(password: string, hash: string): boolean {\r\n  return bcrypt.compareSync(password, hash)\r\n}\r\n\r\n// Generate JWT token\r\nexport function generateToken(user: AdminUser): string {\r\n  return jwt.sign(\r\n    { \r\n      id: user.id, \r\n      email: user.email, \r\n      role: user.role \r\n    },\r\n    JWT_SECRET,\r\n    { expiresIn: '24h' }\r\n  )\r\n}\r\n\r\n// Verify JWT token\r\nexport function verifyToken(token: string): AdminUser | null {\r\n  try {\r\n    const decoded = jwt.verify(token, JWT_SECRET) as any\r\n    return {\r\n      id: decoded.id,\r\n      email: decoded.email,\r\n      role: decoded.role\r\n    }\r\n  } catch (error) {\r\n    return null\r\n  }\r\n}\r\n\r\n// Authenticate admin user\r\nexport function authenticateAdmin(credentials: LoginCredentials): { user: AdminUser; token: string } | null {\r\n  const { email, password } = credentials\r\n  \r\n  // Check credentials\r\n  if (email === ADMIN_CREDENTIALS.email && password === ADMIN_CREDENTIALS.password) {\r\n    const user: AdminUser = {\r\n      id: '1',\r\n      email: ADMIN_CREDENTIALS.email,\r\n      role: ADMIN_CREDENTIALS.role\r\n    }\r\n    \r\n    const token = generateToken(user)\r\n    \r\n    return { user, token }\r\n  }\r\n  \r\n  return null\r\n}\r\n\r\n// Check if user is admin\r\nexport function isAdmin(user: AdminUser | null): boolean {\r\n  return user?.role === 'super_admin' || user?.role === 'admin'\r\n}\r\n"],"names":[],"mappings":";;;;;;;;AAUmB;AAVnB;AACA;;;AAEA,0EAA0E;AAC1E,MAAM,oBAAoB;IACxB,OAAO;IACP,UAAU;IACV,MAAM;AACR;AAEA,MAAM,aAAa,gKAAA,CAAA,UAAO,CAAC,GAAG,CAAC,UAAU,IAAI;AActC,SAAS,aAAa,QAAgB;IAC3C,OAAO,oIAAA,CAAA,UAAM,CAAC,QAAQ,CAAC,UAAU;AACnC;AAGO,SAAS,eAAe,QAAgB,EAAE,IAAY;IAC3D,OAAO,oIAAA,CAAA,UAAM,CAAC,WAAW,CAAC,UAAU;AACtC;AAGO,SAAS,cAAc,IAAe;IAC3C,OAAO,wIAAA,CAAA,UAAG,CAAC,IAAI,CACb;QACE,IAAI,KAAK,EAAE;QACX,OAAO,KAAK,KAAK;QACjB,MAAM,KAAK,IAAI;IACjB,GACA,YACA;QAAE,WAAW;IAAM;AAEvB;AAGO,SAAS,YAAY,KAAa;IACvC,IAAI;QACF,MAAM,UAAU,wIAAA,CAAA,UAAG,CAAC,MAAM,CAAC,OAAO;QAClC,OAAO;YACL,IAAI,QAAQ,EAAE;YACd,OAAO,QAAQ,KAAK;YACpB,MAAM,QAAQ,IAAI;QACpB;IACF,EAAE,OAAO,OAAO;QACd,OAAO;IACT;AACF;AAGO,SAAS,kBAAkB,WAA6B;IAC7D,MAAM,EAAE,KAAK,EAAE,QAAQ,EAAE,GAAG;IAE5B,oBAAoB;IACpB,IAAI,UAAU,kBAAkB,KAAK,IAAI,aAAa,kBAAkB,QAAQ,EAAE;QAChF,MAAM,OAAkB;YACtB,IAAI;YACJ,OAAO,kBAAkB,KAAK;YAC9B,MAAM,kBAAkB,IAAI;QAC9B;QAEA,MAAM,QAAQ,cAAc;QAE5B,OAAO;YAAE;YAAM;QAAM;IACvB;IAEA,OAAO;AACT;AAGO,SAAS,QAAQ,IAAsB;IAC5C,OAAO,MAAM,SAAS,iBAAiB,MAAM,SAAS;AACxD","debugId":null}},
    {"offset": {"line": 83, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Dell/Desktop/digitomreact-10/digitom-nextjs/src/app/admin/layout.tsx"],"sourcesContent":["'use client'\r\n\r\nimport { useEffect, useState } from 'react'\r\nimport { useRouter, usePathname } from 'next/navigation'\r\nimport { verifyToken, AdminUser } from '../../lib/auth'\r\nimport AdminSidebar from '../../Components/Admin/AdminSidebar'\r\nimport AdminHeader from '../../Components/Admin/AdminHeader'\r\n\r\nexport default function AdminLayout({\r\n  children,\r\n}: {\r\n  children: React.ReactNode\r\n}) {\r\n  const [user, setUser] = useState<AdminUser | null>(null)\r\n  const [loading, setLoading] = useState(true)\r\n  const router = useRouter()\r\n  const pathname = usePathname()\r\n\r\n  useEffect(() => {\r\n    const checkAuth = () => {\r\n      const token = localStorage.getItem('admin_token')\r\n      const userData = localStorage.getItem('admin_user')\r\n\r\n      if (!token || !userData) {\r\n        router.push('/admin/login')\r\n        return\r\n      }\r\n\r\n      try {\r\n        const verifiedUser = verifyToken(token)\r\n        if (verifiedUser) {\r\n          setUser(verifiedUser)\r\n        } else {\r\n          localStorage.removeItem('admin_token')\r\n          localStorage.removeItem('admin_user')\r\n          router.push('/admin/login')\r\n        }\r\n      } catch (error) {\r\n        localStorage.removeItem('admin_token')\r\n        localStorage.removeItem('admin_user')\r\n        router.push('/admin/login')\r\n      } finally {\r\n        setLoading(false)\r\n      }\r\n    }\r\n\r\n    checkAuth()\r\n  }, [router])\r\n\r\n  const handleLogout = () => {\r\n    localStorage.removeItem('admin_token')\r\n    localStorage.removeItem('admin_user')\r\n    router.push('/admin/login')\r\n  }\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center\">\r\n        <div className=\"animate-spin rounded-full h-32 w-32 border-b-2 border-indigo-600\"></div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (pathname === '/admin/login') {\r\n    return <>{children}</>\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gray-100\">\r\n      <AdminHeader user={user} onLogout={handleLogout} />\r\n      <div className=\"flex\">\r\n        <AdminSidebar />\r\n        <main className=\"flex-1 p-6\">\r\n          {children}\r\n        </main>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n"],"names":[],"mappings":";;;;AAEA;AACA;AACA;;;;;;;;;;;;;AAJA;;;;;;AAQe,SAAS,YAAY,EAClC,QAAQ,EAGT;;IACC,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAoB;IACnD,MAAM,CAAC,SAAS,WAAW,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACvC,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,WAAW,CAAA,GAAA,qIAAA,CAAA,cAAW,AAAD;IAE3B,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;iCAAE;YACR,MAAM;mDAAY;oBAChB,MAAM,QAAQ,aAAa,OAAO,CAAC;oBACnC,MAAM,WAAW,aAAa,OAAO,CAAC;oBAEtC,IAAI,CAAC,SAAS,CAAC,UAAU;wBACvB,OAAO,IAAI,CAAC;wBACZ;oBACF;oBAEA,IAAI;wBACF,MAAM,eAAe,CAAA,GAAA,qHAAA,CAAA,cAAW,AAAD,EAAE;wBACjC,IAAI,cAAc;4BAChB,QAAQ;wBACV,OAAO;4BACL,aAAa,UAAU,CAAC;4BACxB,aAAa,UAAU,CAAC;4BACxB,OAAO,IAAI,CAAC;wBACd;oBACF,EAAE,OAAO,OAAO;wBACd,aAAa,UAAU,CAAC;wBACxB,aAAa,UAAU,CAAC;wBACxB,OAAO,IAAI,CAAC;oBACd,SAAU;wBACR,WAAW;oBACb;gBACF;;YAEA;QACF;gCAAG;QAAC;KAAO;IAEX,MAAM,eAAe;QACnB,aAAa,UAAU,CAAC;QACxB,aAAa,UAAU,CAAC;QACxB,OAAO,IAAI,CAAC;IACd;IAEA,IAAI,SAAS;QACX,qBACE,6LAAC;YAAI,WAAU;sBACb,cAAA,6LAAC;gBAAI,WAAU;;;;;;;;;;;IAGrB;IAEA,IAAI,aAAa,gBAAgB;QAC/B,qBAAO;sBAAG;;IACZ;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;gBAAY,MAAM;gBAAM,UAAU;;;;;;0BACnC,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;;;;;kCACD,6LAAC;wBAAK,WAAU;kCACb;;;;;;;;;;;;;;;;;;AAKX;GAtEwB;;QAOP,qIAAA,CAAA,YAAS;QACP,qIAAA,CAAA,cAAW;;;KARN","debugId":null}}]
}